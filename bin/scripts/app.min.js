/*! app-framework 31-08-2015 */
define("app/App",function(a,b){var c=(a("nori/utils/Rx"),Nori.createApplication({mixins:[],store:a("app/store/AppStore"),view:a("app/view/AppView"),socket:a("nori/service/SocketIO"),initialize:function(){this.socket.initialize(),this.view.initialize(),this.store.initialize(),this.store.subscribe("storeInitialized",this.onStoreInitialized.bind(this)),this.store.loadStore()},onStoreInitialized:function(){this.runApplication()},runApplication:function(){this.view.removeLoadingMessage(),this.view.render(),this.store.setState({currentState:"PLAYER_SELECT"})},handleSocketMessage:function(a){if(a)switch(console.log("from Socket.IO server",a),a.type){case this.socket.events().CONNECT:return console.log("Connected!"),void this.store.setState({socketIOID:a.id});case this.socket.events().USER_CONNECTED:return void console.log("Another client connected");case this.socket.events().USER_DISCONNECTED:return void console.log("Another client disconnected");case this.socket.events().DROPPED:return void console.log("You were dropped!",a.payload);case this.socket.events().SYSTEM_MESSAGE:return void console.log("System message",a.payload);case this.socket.events().CREATE_ROOM:return void console.log("create room");case this.socket.events().JOIN_ROOM:return void console.log("join room");case this.socket.events().LEAVE_ROOM:return void console.log("leave room");default:return void console.warn("Unhandled SocketIO message type",a)}}}));b.exports=c}),define("app/action/ActionConstants",function(a,b){var c=a("nudoru/core/ObjectUtils");_.merge(b.exports,c.keyMirror({CHANGE_GAME_STATE:null,LOCAL_PLAYER_CONNECT:null,SELECT_PLAYER:null,REMOTE_PLAYER_CONNECT:null,GAME_START:null,LOCAL_QUESTION:null,REMOTE_QUESTION:null,LOCAL_PLAYER_HEALTH_CHANGE:null,REMOTE_PLAYER_HEALTH_CHANGE:null,GAME_OVER:null}))}),define("app/Action/ActionCreator",function(a,b){var c=a("app/action/ActionConstants"),d={mutateSomeData:function(a){var b={type:c.MUTATION_TYPE,payload:{data:a}};return b}};b.exports=d}),define("app/store/AppStore",function(a,b){var c=a("nori/action/ActionConstants"),d=a("nori/store/MixinMapFactory"),e=a("nori/utils/MixinObservableSubject"),f=a("nori/store/MixinReducerStore"),g=Nori.createStore({mixins:[d,f,e()],gameStates:["TITLE","PLAYER_SELECT","WAITING_ON_PLAYER","MAIN_GAME","GAME_OVER"],initialize:function(){this.addReducer(this.defaultReducerFunction),this.initializeReducerStore(),this.setState(Nori.config()),this.createSubject("storeInitialized")},loadStore:function(){this.setState({currentState:this.gameStates[0],localPlayer:{},remotePlayer:{},questionBank:[]}),this.notifySubscribersOf("storeInitialized")},createUserObject:function(a,b,c,d,e){return{id:a,type:b,name:c,health:health||6,appearance:d,behaviors:e||[]}},createQuestionObject:function(a,b,c){return{prompt:a,distractors:b,pointValue:c}},defaultReducerFunction:function(a,b){switch(a=a||{},b.type){case c.CHANGE_STORE_STATE:return _.assign({},a,b.payload.data);default:return a}},handleStateMutation:function(){this.notifySubscribers(this.getState())}});b.exports=g()}),define("app/view/AppView",function(a,b){var c=a("app/store/AppStore"),d=a("nori/view/ApplicationView"),e=a("nori/view/MixinNudoruControls"),f=a("nori/view/MixinComponentViews"),g=a("nori/view/MixinStoreStateViews"),h=a("nori/view/MixinEventDelegator"),i=a("nori/utils/MixinObservableSubject"),j=Nori.createView({mixins:[d,e,f,g,h(),i()],initialize:function(){this.initializeApplicationView(["applicationscaffold","applicationcomponentsscaffold"]),this.initializeStateViews(c),this.initializeNudoruControls(),this.configureViews()},configureViews:function(){var b=a("app/view/Screen.Title")(),d=a("app/view/Screen.PlayerSelect")(),e=a("app/view/Screen.WaitingOnPlayer")(),f=a("app/view/Screen.MainGame")(),g=a("app/view/Screen.GameOver")(),h=c.gameStates;this.setViewMountPoint("#contents"),this.mapStateToViewComponent(h[0],"title",b),this.mapStateToViewComponent(h[1],"playerselect",d),this.mapStateToViewComponent(h[2],"waitingonplayer",e),this.mapStateToViewComponent(h[3],"game",f),this.mapStateToViewComponent(h[4],"gameover",g)},render:function(){}});b.exports=j()}),define("app/view/DebugControlsTestingSubView",function(a,b){var c=function(){function b(){j.initialize()}function c(){console.log(this.getID()+", subview did mount"),d=document.getElementById("action-one"),e=document.getElementById("action-two"),f=document.getElementById("action-three"),g=document.getElementById("action-four"),h=document.getElementById("action-five"),i=document.getElementById("action-six"),k.add({title:"",content:"This is a button, you click it dummy. This is a button, you click it dummy. ",position:"L",targetEl:g,type:"information"}),k.add({title:"",content:"This is a button, you click it dummy. This is a button, you click it dummy. ",position:"B",targetEl:g,type:"information"}),k.add({title:"",content:"This is a button, you click it dummy. This is a button, you click it dummy. This is a button, you click it dummy. ",position:"R",targetEl:g,type:"information"}),k.add({title:"",content:"This is a button, you click it dummy. This is a button, you click it dummy. This is a button, you click it dummy. This is a button, you click it dummy. ",position:"T",targetEl:g,type:"information"}),d.addEventListener("click",function(){Nori.view().addMessageBox({title:j.getSentence(2,4),content:j.getParagraph(2,4),type:"warning",modal:!0,width:500})}),e.addEventListener("click",function(){Nori.view().addMessageBox({title:j.getSentence(10,20),content:j.getParagraph(2,4),type:"default",modal:!1,buttons:[{label:"Yes",id:"yes",type:"default",icon:"check",onClick:function(){console.log("yes")}},{label:"Maybe",id:"maybe",type:"positive",icon:"cog",onClick:function(){console.log("maybe")}},{label:"Nope",id:"nope",type:"negative",icon:"times"}]})}),f.addEventListener("click",function(){Nori.view().addNotification({title:j.getSentence(3,6),type:"information",content:j.getParagraph(1,2)}),k.remove(g)}),g.addEventListener("click",function(){console.log("Four")}),h.addEventListener("click",function(){Nori.dispatcher().publish({type:l.CHANGE_ROUTE,payload:{route:"/one",data:{prop:"some data",moar:"25"}}})}),i.addEventListener("click",function(){Nori.dispatcher().publish({type:l.CHANGE_ROUTE,payload:{route:"/styles",data:"test"}})})}var d,e,f,g,h,i,j=a("nudoru/browser/Lorem"),k=a("nudoru/component/ToolTipView"),l=a("nori/action/ActionConstants");return{initialize:b,componentDidMount:c}};b.exports=c}),define("app/view/Screen.GameOver",function(a,b){var c=a("nori/action/ActionCreator"),d=a("app/view/AppView"),e=a("app/store/AppStore"),f=d.createComponentView({initialize:function(){},defineEvents:function(){return{"click #gameover__button-replay":function(){e.apply(c.changeStoreState({currentState:e.gameStates[1]}))}}},getInitialState:function(){return e.getState()},componentWillUpdate:function(){var a=e.getState();return a.greeting+=" (updated)",a},componentDidMount:function(){},componentWillUnmount:function(){}});b.exports=f}),define("app/view/Screen.MainGame",function(a,b){var c=a("nori/action/ActionCreator"),d=a("app/view/AppView"),e=a("app/store/AppStore"),f=d.createComponentView({initialize:function(){},defineEvents:function(){return{"click #game__button-skip":function(){e.apply(c.changeStoreState({currentState:e.gameStates[4]}))}}},getInitialState:function(){return e.getState()},componentWillUpdate:function(){var a=e.getState();return a.greeting+=" (updated)",a},componentDidMount:function(){},componentWillUnmount:function(){}});b.exports=f}),define("app/view/Screen.PlayerSelect",function(a,b){var c=a("nori/action/ActionCreator"),d=a("app/view/AppView"),e=a("app/store/AppStore"),f=d.createComponentView({initialize:function(){},defineEvents:function(){return{"click #select__button-joinroom":this.onJoinRoom.bind(this),"click #select__button-createroom":this.onCreateRoom.bind(this),"click #select__button-go":function(){e.apply(c.changeStoreState({currentState:e.gameStates[2]}))}}},getInitialState:function(){return e.getState()},componentWillUpdate:function(){var a=e.getState();return a.greeting+=" (updated)",a},componentDidMount:function(){},onJoinRoom:function(){var a=document.querySelector("#select__roomid").value;console.log("Join room "+a),this.validateRoomID(a)?(console.log("Room ID OK"),d.notify("","Room ID ok!")):d.alert("Bad Room ID","The room ID is not correct. Must be a 5 digit number.")},validateRoomID:function(a){return isNaN(parseInt(a))?!1:5!==a.length?!1:!0},onCreateRoom:function(){console.log("create room")},componentWillUnmount:function(){}});b.exports=f}),define("app/view/Screen.Title",function(a,b){var c=a("nori/action/ActionCreator"),d=a("app/view/AppView"),e=a("app/store/AppStore"),f=d.createComponentView({initialize:function(){},defineEvents:function(){return{"click #title__button-start":function(){e.apply(c.changeStoreState({currentState:e.gameStates[1]}))}}},getInitialState:function(){return e.getState()},componentWillUpdate:function(){var a=e.getState();return a.greeting+=" (updated)",a},componentDidMount:function(){},componentWillUnmount:function(){}});b.exports=f}),define("app/view/Screen.WaitingOnPlayer",function(a,b){var c=a("nori/action/ActionCreator"),d=a("app/view/AppView"),e=a("app/store/AppStore"),f=d.createComponentView({initialize:function(){},defineEvents:function(){return{"click #waiting__button-skip":function(){e.apply(c.changeStoreState({currentState:e.gameStates[3]}))}}},getInitialState:function(){return e.getState()},componentWillUpdate:function(){var a=e.getState();return a.greeting+=" (updated)",a},componentDidMount:function(){},componentWillUnmount:function(){}});b.exports=f}),define("app/view/TemplateViewComponent",function(a,b){var c=a("app/view/AppView"),d=c.createComponentView({initialize:function(){},getInitialState:function(){return APP.store().getState()},componentWillUpdate:function(){var a=APP.store().getState();return a.greeting+=" (updated)",a},componentDidMount:function(){},componentWillUnmount:function(){}});b.exports=d}),function(){var a=require("nudoru/browser/BrowserInfo");a.notSupported||a.isIE9?document.querySelector("body").innerHTML="<h3>For the best experience, please use Internet Explorer 10+, Firefox, Chrome or Safari to view this application.</h3>":window.onload=function(){window.APP=require("app/App"),APP.initialize()}}();
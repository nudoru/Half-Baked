/*! app-framework 28-08-2015 */
define("app/App",function(a,b){var c=a("nori/utils/Rx"),d=Nori.createApplication({mixins:[],appModel:a("app/model/AppModel"),appView:a("app/view/AppView"),socket:a("nori/service/SocketIO"),initialize:function(){this.initializeApplication(),this.socket.initialize(),this.view().initialize(),this.model().initialize(),this.model().subscribe("storeInitialized",this.onStoreInitialized.bind(this)),this.model().loadStore()},onStoreInitialized:function(){this.runApplication()},runApplication:function(){this.view().removeLoadingMessage(),this.view().render(),this.model().setState({currentState:"PLAYER_SELECT"}),c.interval(500).take(5).subscribe(function(){this.socket.ping()}.bind(this))},handleSocketMessage:function(a){if(a)switch(console.log("from Socket.IO server",a),a.type){case this.socket.events().CONNECT:return console.log("Connected!"),void this.model().setState({socketIOID:a.id});case this.socket.events().USER_CONNECTED:return void console.log("Another client connected");case this.socket.events().USER_DISCONNECTED:return void console.log("Another client disconnected");case this.socket.events().DROPPED:return void console.log("You were dropped!",a.payload);case this.socket.events().SYSTEM_MESSAGE:return void console.log("System message",a.payload);case this.socket.events().CREATE_ROOM:return void console.log("create room");case this.socket.events().JOIN_ROOM:return void console.log("join room");case this.socket.events().LEAVE_ROOM:return void console.log("leave room");default:return void console.warn("Unhandled SocketIO message type",a)}}});b.exports=d}),define("app/action/ActionConstants",function(a,b){var c=a("nudoru/core/ObjectUtils");_.merge(b.exports,c.keyMirror({CHANGE_GAME_STATE:null,LOCAL_PLAYER_CONNECT:null,SELECT_PLAYER:null,REMOTE_PLAYER_CONNECT:null,GAME_START:null,LOCAL_QUESTION:null,REMOTE_QUESTION:null,LOCAL_PLAYER_HEALTH_CHANGE:null,REMOTE_PLAYER_HEALTH_CHANGE:null,GAME_OVER:null}))}),define("app/Action/ActionCreator",function(a,b){var c=a("app/action/ActionConstants"),d={mutateSomeData:function(a){var b={type:c.MUTATION_TYPE,payload:{data:a}};return b}};b.exports=d}),define("app/model/AppModel",function(a,b){var c=(a("nori/action/ActionCreator"),a("nori/action/ActionConstants")),d=a("nori/model/MixinMapFactory"),e=a("nori/utils/MixinObservableSubject"),f=a("nori/model/MixinReducerModel"),g=Nori.createApplicationModel({mixins:[d,f,e()],gameStates:["TITLE","PLAYER_SELECT","WAITING_ON_PLAYER","MAIN_GAME","GAME_OVER"],initialize:function(){this.addReducer(this.defaultReducerFunction),this.initializeReducerModel(),this.setState(Nori.config()),this.createSubject("storeInitialized")},loadStore:function(){this.setState({currentState:this.gameStates[0],localPlayer:{},remotePlayer:{},questionBank:[]}),this.notifySubscribersOf("storeInitialized")},createUserObject:function(a,b,c,d,e){return{id:a,type:b,name:c,health:health||6,appearance:d,behaviors:e||[]}},createQuestionObject:function(a,b,c){return{prompt:a,distractors:b,pointVaule:c}},defaultReducerFunction:function(a,b){switch(a=a||{},b.type){case c.CHANGE_MODEL_STATE:return _.assign({},a,b.payload.data);default:return a}},handleStateMutation:function(){this.notifySubscribers(this.getState())}});b.exports=g}),define("app/view/AppView",function(a,b){var c=(a("nori/action/ActionCreator"),a("nori/action/ActionConstants"),a("nori/view/ApplicationView")),d=a("nori/view/MixinNudoruControls"),e=a("nori/view/MixinComponentViews"),f=a("nori/view/MixinModelStateViews"),g=a("nori/view/MixinEventDelegator"),h=a("nori/utils/MixinObservableSubject"),i=Nori.createApplicationView({mixins:[c,d,e,f,g(),h()],initialize:function(){this.initializeApplicationView(["applicationscaffold","applicationcomponentsscaffold"]),this.initializeStateViews(),this.initializeNudoruControls(),this.configureViews()},configureViews:function(){var b=a("app/view/Screen.Title")(),c=a("app/view/Screen.PlayerSelect")(),d=a("app/view/Screen.WaitingOnPlayer")(),e=a("app/view/Screen.MainGame")(),f=a("app/view/Screen.GameOver")(),g=Nori.model().gameStates;this.setViewMountPoint("#contents"),this.mapStateToViewComponent(g[0],"title",b),this.mapStateToViewComponent(g[1],"playerselect",c),this.mapStateToViewComponent(g[2],"waitingonplayer",d),this.mapStateToViewComponent(g[3],"game",e),this.mapStateToViewComponent(g[4],"gameover",f)},render:function(){}});b.exports=i}),define("app/view/DebugControlsTestingSubView",function(a,b){var c=function(){function b(){j.initialize()}function c(){console.log(this.getID()+", subview did mount"),d=document.getElementById("action-one"),e=document.getElementById("action-two"),f=document.getElementById("action-three"),g=document.getElementById("action-four"),h=document.getElementById("action-five"),i=document.getElementById("action-six"),k.add({title:"",content:"This is a button, you click it dummy. This is a button, you click it dummy. ",position:"L",targetEl:g,type:"information"}),k.add({title:"",content:"This is a button, you click it dummy. This is a button, you click it dummy. ",position:"B",targetEl:g,type:"information"}),k.add({title:"",content:"This is a button, you click it dummy. This is a button, you click it dummy. This is a button, you click it dummy. ",position:"R",targetEl:g,type:"information"}),k.add({title:"",content:"This is a button, you click it dummy. This is a button, you click it dummy. This is a button, you click it dummy. This is a button, you click it dummy. ",position:"T",targetEl:g,type:"information"}),d.addEventListener("click",function(){Nori.view().addMessageBox({title:j.getSentence(2,4),content:j.getParagraph(2,4),type:"warning",modal:!0,width:500})}),e.addEventListener("click",function(){Nori.view().addMessageBox({title:j.getSentence(10,20),content:j.getParagraph(2,4),type:"default",modal:!1,buttons:[{label:"Yes",id:"yes",type:"default",icon:"check",onClick:function(){console.log("yes")}},{label:"Maybe",id:"maybe",type:"positive",icon:"cog",onClick:function(){console.log("maybe")}},{label:"Nope",id:"nope",type:"negative",icon:"times"}]})}),f.addEventListener("click",function(){Nori.view().addNotification({title:j.getSentence(3,6),type:"information",content:j.getParagraph(1,2)}),k.remove(g)}),g.addEventListener("click",function(){console.log("Four")}),h.addEventListener("click",function(){Nori.dispatcher().publish({type:l.CHANGE_ROUTE,payload:{route:"/one",data:{prop:"some data",moar:"25"}}})}),i.addEventListener("click",function(){Nori.dispatcher().publish({type:l.CHANGE_ROUTE,payload:{route:"/styles",data:"test"}})})}var d,e,f,g,h,i,j=a("nudoru/browser/Lorem"),k=a("nudoru/component/ToolTipView"),l=a("nori/action/ActionConstants");return{initialize:b,componentDidMount:c}};b.exports=c}),define("app/view/Screen.GameOver",function(a,b){var c=a("nori/action/ActionCreator"),d=(a("app/action/ActionConstants"),Nori.view().createComponentView({initialize:function(){},defineEvents:function(){return{"click #gameover__button-replay":function(){APP.model().apply(c.changeModelState({currentState:Nori.model().gameStates[1]}))}}},getInitialState:function(){return APP.model().getState()},componentWillUpdate:function(){var a=APP.model().getState();return a.greeting+=" (updated)",a},componentDidMount:function(){},componentWillUnmount:function(){}}));b.exports=d}),define("app/view/Screen.MainGame",function(a,b){var c=a("nori/action/ActionCreator"),d=(a("app/action/ActionConstants"),Nori.view().createComponentView({initialize:function(){},defineEvents:function(){return{"click #game__button-skip":function(){APP.model().apply(c.changeModelState({currentState:Nori.model().gameStates[4]}))}}},getInitialState:function(){return APP.model().getState()},componentWillUpdate:function(){var a=APP.model().getState();return a.greeting+=" (updated)",a},componentDidMount:function(){},componentWillUnmount:function(){}}));b.exports=d}),define("app/view/Screen.PlayerSelect",function(a,b){var c=a("nori/action/ActionCreator"),d=(a("app/action/ActionConstants"),Nori.view().createComponentView({initialize:function(){},defineEvents:function(){return{"click #select__button-joinroom":this.onJoinRoom.bind(this),"click #select__button-createroom":this.onCreateRoom.bind(this),"click #select__button-go":function(){APP.model().apply(c.changeModelState({currentState:Nori.model().gameStates[2]}))}}},getInitialState:function(){return APP.model().getState()},componentWillUpdate:function(){var a=APP.model().getState();return a.greeting+=" (updated)",a},componentDidMount:function(){},onJoinRoom:function(){var a=document.querySelector("#select__roomid").value;console.log("Join room "+a),this.validateRoomID(a)?(console.log("Room ID OK"),c.notifyUser("","Room ID ok!")):c.alertUser("Bad Room ID","The room ID is not correct. Must be a 5 digit number.")},validateRoomID:function(a){return isNaN(parseInt(a))?!1:5!==a.length?!1:!0},onCreateRoom:function(){console.log("create room")},componentWillUnmount:function(){}}));b.exports=d}),define("app/view/Screen.Title",function(a,b){var c=a("nori/action/ActionCreator"),d=(a("app/action/ActionConstants"),Nori.view().createComponentView({initialize:function(){},defineEvents:function(){return{"click #title__button-start":function(){APP.model().apply(c.changeModelState({currentState:Nori.model().gameStates[1]}))}}},getInitialState:function(){return APP.model().getState()},componentWillUpdate:function(){var a=APP.model().getState();return a.greeting+=" (updated)",a},componentDidMount:function(){},componentWillUnmount:function(){}}));b.exports=d}),define("app/view/Screen.WaitingOnPlayer",function(a,b){var c=a("nori/action/ActionCreator"),d=(a("app/action/ActionConstants"),Nori.view().createComponentView({initialize:function(){},defineEvents:function(){return{"click #waiting__button-skip":function(){APP.model().apply(c.changeModelState({currentState:Nori.model().gameStates[3]}))}}},getInitialState:function(){return APP.model().getState()},componentWillUpdate:function(){var a=APP.model().getState();return a.greeting+=" (updated)",a},componentDidMount:function(){},componentWillUnmount:function(){}}));b.exports=d}),define("app/view/TemplateViewComponent",function(a,b){var c=Nori.view().createComponentView({initialize:function(){},getInitialState:function(){return APP.model().getState()},componentWillUpdate:function(){var a=APP.model().getState();return a.greeting+=" (updated)",a},componentDidMount:function(){},componentWillUnmount:function(){}});b.exports=c}),define("app/view/TemplateViewComponentFactory",function(a,b){var c=function(){function a(){}function b(){var a=Object.create(null);this.setState(a)}function c(){}function d(){}return{initialize:a,componentWillUpdate:b,componentDidMount:c,componentWillUnmount:d}};b.exports=c}),function(){var a=require("nudoru/browser/BrowserInfo");a.notSupported||a.isIE9?document.querySelector("body").innerHTML="<h3>For the best experience, please use Internet Explorer 10+, Firefox, Chrome or Safari to view this application.</h3>":window.onload=function(){window.APP=require("app/App"),APP.initialize()}}();